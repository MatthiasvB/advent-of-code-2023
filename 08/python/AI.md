This python code has been translated from TS by ChatGPT (GPT-4o). It was done with only negligible errors.